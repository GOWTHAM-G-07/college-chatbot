<form id="loginForm">
  <input id="email" required>
  <input id="password" type="password" required>
  <button>Login</button>
</form>

<script>
loginForm.onsubmit = async e => {
  e.preventDefault();

  const res = await fetch("http://127.0.0.1:8000/login", {
    method:"POST",
    headers:{"Content-Type":"application/x-www-form-urlencoded"},
    body:new URLSearchParams({
      email:email.value,
      password:password.value
    })
  });

  const data = await res.json();
  if(!res.ok){ alert(data.detail); return; }

  localStorage.setItem("user",JSON.stringify(data));

  data.role==="admin"
    ? location.href="dashboard.html"
    : location.href="chat.html";
};
</script>
